option_settings:
  # Node.js settings
  aws:elasticbeanstalk:container:nodejs:
    NodeCommand: "npm start"
    NodeVersion: 18.18.0
    ProxyServer: nginx
    
  # Environment properties
  aws:elasticbeanstalk:application:environment:
    NODE_ENV: production
    PORT: 8080
    
  # Instance settings
  aws:autoscaling:launchconfiguration:
    InstanceType: t2.micro
    IamInstanceProfile: aws-elasticbeanstalk-ec2-role
    
  # Load balancer settings
  aws:elasticbeanstalk:environment:
    LoadBalancerType: application
    ServiceRole: aws-elasticbeanstalk-service-role
    
  # Health check
  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /api/health
    Port: '8080'
    Protocol: HTTP
    
  # Managed updates
  aws:elasticbeanstalk:managedactions:
    ManagedActionsEnabled: true
    PreferredStartTime: "Sun:10:00"
    
  # Deployment settings
  aws:elasticbeanstalk:command:
    DeploymentPolicy: RollingWithAdditionalBatch
    
# Files to create
files:
  "/opt/elasticbeanstalk/hooks/appdeploy/post/99_make_uploads_dir.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      mkdir -p /var/app/current/uploads
      chmod 755 /var/app/current/uploads
